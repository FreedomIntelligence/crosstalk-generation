'''
Author: anon
Date: 2022-02-07 11:05:00
LastEditors: anon
LastEditTime: 2022-02-07 11:05:00
FilePath: /crosstalk-generation/src/gpt/draw_loss.py
Description: 

Copyright (c) 2022 by anon/Ultrapower, All Rights Reserved. 
'''

import numpy as np
import matplotlib.pyplot as plt

train_loss = [44.48271321031384, 6.583550890944058, 5.2243800984289415, 4.793724752727308, 4.509950302328382, 4.293438681534359, 4.118832167109153, 3.9655399139662433, 3.8359335477190806, 3.7205823993324336, 3.6183518121117038, 3.529470994508356, 3.454126060367527, 3.3876399215002704, 3.327385791979338, 3.2738280115270975, 3.2241040730834905, 3.1793050898645157, 3.1380796483584814, 3.097194073881422, 3.058997189281578, 3.0224359229095, 2.989321135847192, 2.956893386876673, 2.925039403779166, 2.8960848723139083, 2.8673695635078547, 2.838541273156503, 2.812697682255193, 2.7858682384168296, 2.760819730185028, 2.7354322604666974, 2.7120282050362206, 2.688629031988015, 2.666998180500547, 2.6451193193744, 2.6239456789834157, 2.603371260578471, 2.5841847509369815, 2.565063550597743, 2.54530718102491, 2.527386322415861, 2.510184377118161, 2.4923996164386435, 2.4756604128762296, 2.459907821246556, 2.442924183651917, 2.426776533825953, 2.411911290211785, 2.3977591939438554, 2.383567075801075, 2.3692382172982493, 2.3537363544890755, 2.3426682418898532, 2.3303275399190144, 2.315959686444218, 2.30516399629134, 2.293007003140629, 2.2806038615846993, 2.2688294145397676, 2.259110706417184, 2.2488786947906467, 2.2375688153101985, 2.227671702463824, 2.217756683709926, 2.208003384995281, 2.1991461373809584, 2.191128186623853, 2.1806941671927174, 2.172695298436889, 2.1649881235638957, 2.1569865969338813, 2.148207969056036, 2.1422095429628416, 2.1350791305079495, 2.1268079251275025, 2.120990522060179, 2.1148893516762812, 2.107709726803285, 2.1024627320300366, 2.096419497584938, 2.0913853452169806, 2.085944129067256, 2.0798576306579704, 2.077440956615864, 2.071507751762419, 2.0658729361860377, 2.063466019558727, 2.0598251012034883, 2.0547408370147076, 2.051986127733288, 2.049203844536516, 2.0468371813906763, 2.043903685153875, 2.0411412049505047, 2.0387904661490506, 2.0368946077232075, 2.0359663403571995, 2.0344403394182824, 2.0328974296275835]
valid_loss = [6.632119738052938, 4.592151895119023, 4.284870942433675, 4.1230103282542245, 4.030122367763816, 3.9413269297727545, 3.895269082714093, 3.8443484729695543, 3.8023344192920816, 3.781304602682405, 3.753471881058357, 3.7412116174757295, 3.730542713979323, 3.725996570423756, 3.716093263150747, 3.7090776037204303, 3.7108728900505374, 3.713725692015199, 3.7089336805997237, 3.7278165965808143, 3.719184803071423, 3.731867850012497, 3.7419109656431964, 3.753017064195556, 3.758844084457445, 3.7659045639810533, 3.7814736303139327, 3.7981787303526455, 3.80679324631379, 3.817094279969593, 3.8320516451868314, 3.8536363416743056, 3.8638582586128023, 3.8662699947476016, 3.8776759202606583, 3.8897769759377216, 3.9205473858248037, 3.9219261240736345, 3.9313435045729546, 3.9452734907096794, 3.9682855379544315, 3.9751413908331563, 3.983424531336514, 3.9876989508715, 4.0045680049052494, 4.033595425688961, 4.0295334879854385, 4.054913828306109, 4.058664200461913, 4.07562237253813, 4.095141318728248, 4.103051297018461, 4.1247230697643715, 4.131437508859367, 4.146622050217007, 4.158886610904586, 4.184614694007089, 4.1859706075763405, 4.188921441170286, 4.206857152817034, 4.228782836893266, 4.224493684427018, 4.237151153733797, 4.247350576510682, 4.235146184576634, 4.2600116291521495, 4.268260229042386, 4.295261158750065, 4.290834169150141, 4.300445780947201, 4.309303197905282, 4.3218370568343785, 4.333605740300592, 4.338023634714501, 4.359051271391063, 4.346706262258726, 4.375257317150865, 4.376839564225384, 4.384927596629966, 4.391139392912202, 4.396961501825635, 4.409217323840965, 4.4099885875190905, 4.426319476228636, 4.4286229317062, 4.4389782397546504, 4.436613840477489, 4.434759803650164, 4.448284151398133, 4.447159450373546, 4.455189101049833, 4.451785619756515, 4.465889912156673, 4.465894921917782, 4.460803010753382, 4.465916545591622, 4.471542153774392, 4.4720834735026616, 4.473313391394333, 4.477410685607578]

fig = plt.figure()
x = np.arange(len(train_loss))

yerr = np.linspace(0.05, 0.2, len(train_loss))

plt.plot(x, train_loss,  label='train-loss')

plt.plot(x, valid_loss,  label='valid-loss')



plt.legend(loc='lower right')
plt.savefig('t5_small_loss.png')
